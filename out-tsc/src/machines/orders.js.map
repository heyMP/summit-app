{"version":3,"file":"orders.js","sourceRoot":"","sources":["../../../src/machines/orders.ts"],"names":[],"mappings":"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","sourcesContent":["import { createMachine, send, assign, interpret, createSchema, sendParent, spawn } from 'xstate'\nimport type { Interpreter, Subscription, StateMachine, InvokeCreator } from 'xstate';\nimport { counterInterval } from './counter.js';\n\nexport type OrderId = string | number | null;\n\nexport interface Order {\n\torderId: OrderId;\n\tcountdown: number;\n\tstate: 'pending' | 'color' | 'frame' | 'bake' | 'seat' | 'wheels' | 'handles' | 'pedals' | 'shipping' | 'complete';\n}\n\nexport type OrderEvent =\n  | { type: 'NEXT' }\n  | { type: 'TICK' }\n\nexport const orderMachine = createMachine({\n\tid: 'order',\n\tinitial: 'color',\n\tschema: {\n\t\tcontext: createSchema<Order>(),\n\t\tevents: createSchema<OrderEvent>(),\n\t},\n\tcontext: {\n\t\t// @ts-ignore\n\t\torderId: null,\n\t\tcountdown: 55,\n\t\tstate: 'pending',\n\t},\n\tinvoke: [\n\t\t{ id: 'counterInterval', src: () => counterInterval },\n\t],\n\ton: {\n\t\t'TICK': {\n\t\t\tactions: 'decrementCount',\n\t\t},\n\t},\n\tstates: {\n\t\tcolor: {\n\t\t\tentry: assign(() => ({ state: 'color' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'frame',  }\n\t\t\t}\n\t\t},\n\t\tframe: {\n\t\t\tentry: assign(() => ({ state: 'color' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'bake' }\n\t\t\t}\n\t\t},\n\t\tbake: {\n\t\t\tentry: assign(() => ({ state: 'bike' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'seat' }\n\t\t\t}\n\t\t},\n\t\tseat: {\n\t\t\tentry: assign(() => ({ state: 'seat' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'wheels' }\n\t\t\t}\n\t\t},\n\t\twheels: {\n\t\t\tentry: assign(() => ({ state: 'wheels' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'handles' }\n\t\t\t}\n\t\t},\n\t\thandles: {\n\t\t\tentry: assign(() => ({ state: 'handles' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'shipping' }\n\t\t\t}\n\t\t},\n\t\tshipping: {\n\t\t\tentry: assign(() => ({ state: 'shipping' })),\n\t\t\ton: {\n\t\t\t\tNEXT: { target: 'save' }\n\t\t\t}\n\t\t},\n\t\tsave: {\n\t\t\tinvoke: {\n\t\t\t\tid: 'saveOrder',\n\t\t\t\tsrc: (context) => saveOrder(context as Order),\n\t\t\t\tonDone: {\n\t\t\t\t\ttarget: 'complete',\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcomplete: {\n\t\t\tentry: assign(() => ({ state: 'complete' })),\n\t\t\ttype: 'final'\n\t\t}\n\t}\n}, {\n\tactions: {\n\t\t// @ts-ignore\n\t\tdecrementCount: assign((context, event) => {\n\t\t\treturn {\n\t\t\t\t// @ts-ignore\n\t\t\t\tcountdown: context.countdown - 1\n\t\t\t}\n\t\t}),\n\t}\n});\n\n\n// @ts-ignore\nconst saveOrder = (order: Order) => new Promise(resolve => setTimeout(resolve, 3000));"]}